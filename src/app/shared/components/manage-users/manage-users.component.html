<div class="container-choose">
    <div style="display: flex; flex-direction: column;" class="button-habilitation">
        <button pButton type="button" (click)="mostrarDiv()" severity="success" *ngIf="!habilitarDiv">Habilitar Estudiantes</button>
        <button pButton type="button" (click)="mostrarDiv2()" severity="danger" *ngIf="!deshabilitarDiv">Deshabilitar Estudiantes</button>
    </div>
    <div class="dropdown-content" *ngIf="habilitarDiv || deshabilitarDiv">
        <div *ngIf="habilitarDiv">
            <p-dropdown 
            [options]="concerts" 
            [(ngModel)]="concertChoice" 
            optionLabel="nombre"
            placeholder="Elegir Concierto" 
            [ngModelOptions]="{standalone: true}"/>
        </div>
        <div>
            <p-dropdown 
            [options]="ciclos" 
            [(ngModel)]="cicloChoice" 
            (ngModelChange)="onCicloChange($event)"
            optionLabel="ciclo"
            placeholder="Elegir Ciclo" 
            [ngModelOptions]="{standalone: true}"/>
        </div>
        <div>
            <p-dropdown
            [options]="niveles" 
            [(ngModel)]="nivelChoice" 
            optionLabel="nivel"
            placeholder="Elegir Nivel" 
            [ngModelOptions]="{standalone: true}"/>
        </div>
        <div>
            <p-dropdown 
            [options]="divisiones" 
            [(ngModel)]="divisionChoice" 
            optionLabel="division"
            placeholder="Elegir Division" 
            [ngModelOptions]="{standalone: true}"/>
        </div>
        <button pButton type="button" (click)="verFiltro()" class="pi pi-search"></button>
    </div>
</div>

<div class="content-habilitation" *ngIf="concertChoice && habilitarDiv">
    <p-floatLabel>
        <p-calendar 
        [(ngModel)]="dateFrom" 
        inputId="from" 
        [minDate]="today"
        dateFormat="dd/mm/yy"/>
        <label for="from">Desde</label>
    </p-floatLabel>
    <p-floatLabel>
        <p-calendar 
        [(ngModel)]="dateTo" 
        inputId="to"
        [minDate]="today"
        dateFormat="dd/mm/yy"/>
        <label for="to">Hasta</label>
    </p-floatLabel>
</div>
<div class="confirm-habilitation">
    <button 
        pButton 
        type="button" 
        (click)="habilitar(concertChoice,$event)" 
        severity="success" 
        icon="pi pi-check" 
        *ngIf="habilitarDiv" 
        [disabled]="!dateFrom && !dateTo && !concertChoice"></button>
    <button 
        pButton 
        type="button" 
        (click)="deshabilitar(concertChoice,$event)" 
        severity="danger" 
        icon="pi pi-times-circle" 
        *ngIf="deshabilitarDiv"
        [disabled]="!cicloChoice || !divisionChoice || !nivelChoice"></button>
</div>
<p-confirmDialog />

<div class="container-table">
    <p-table 
    #dt2 
    [value]="filteredUsers" 
    [scrollable]="true" 
    scrollHeight="400px" 
    [tableStyle]="{'width': 'auto', 'margin':'0 auto'}"
    [lazy]="true"
    [loading]="loading"
    [totalRecords]="totalRecords"
    [rows]="rowsPerPage"
    [globalFilterFields]="['dni', 'apellido', 'nombre', 'ciclo','nivel','division','concert']"
    (onlazy)="loadData($event)">
    <ng-template pTemplate="caption" style="width: 50%;">
        <div class="caption">
            <p-iconField iconPosition="right" class="ml-auto">
                <p-inputIcon>
                    <i class="pi pi-search"></i>
                </p-inputIcon>
                <input 
                pInputText 
                type="text" 
                (input)="dt2.filterGlobal($any($event.target).value, 'contains')" 
                placeholder="Buscar..." />
            </p-iconField>
        </div>
    </ng-template>
    <ng-template pTemplate="header">
        <tr>
            <th pSortableColumn="dni">
                DNI <p-sortIcon field="dni" />
            </th>
            <th pSortableColumn="apellido">
                Apellido <p-sortIcon field="apellido" />
            </th>
            <th pSortableColumn="nombre">
                Nombre <p-sortIcon field="nombre" />
            </th>
            <th pSortableColumn="ciclo">
                Ciclo <p-sortIcon field="ciclo" />
            </th>
            <th pSortableColumn="nivel">
                Nivel <p-sortIcon field="nivel" />
            </th>
            <th pSortableColumn="division">
                Division <p-sortIcon field="division" />
            </th>
            <th pSortableColumn="concert">
                Concert habilitado
            </th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-user>
        <tr>
            <td>{{ user.dni }}</td>
            <td>{{ user.apellido }}</td>
            <td>{{ user.nombre }}</td>
            <td>{{ user.ciclo }}</td>
            <td>{{ user.anio }}</td>
            <td>{{ user.division }}</td>
            <td>{{ user.dni }}</td>
        </tr>
    </ng-template>
</p-table>
</div>